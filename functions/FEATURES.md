# 🚀 股健檢功能總覽

## 📊 核心功能

### 1. 股票查詢與分析
- **即時股票資料**: 支援台股、美股查詢
- **健康分數計算**: 綜合財務指標評分
- **技術分析**: 價格趨勢、成交量分析
- **基本面分析**: 財報數據、估值指標

### 2. ETF 分析
- **台灣ETF資料庫**: 涵蓋主要ETF產品
- **殖利率分析**: 目標殖利率計算
- **費用率比較**: 成本效益分析
- **風險評估**: 波動度、最大回撤

### 3. AI 智能分析
- **投資建議**: 買入/持有/賣出建議
- **風險評估**: 綜合風險指標
- **市場情緒**: 技術指標分析
- **個性化報告**: 根據用戶偏好調整

## 🆕 體質分析功能 (新增)

### 功能概述
體質分析是股健檢的核心新功能，為股票和ETF提供全面的健康評估，幫助投資者做出更明智的投資決策。

### 支援的指令格式
```
# 股票體質分析
2330 體質
2330 健康
體質 2330
健康 2330

# ETF體質分析
0050 體質
0050 健康
體質 0050
健康 0050

# 英文指令
2330 HEALTH
HEALTH 2330
```

### 分析內容
1. **📊 綜合分析結果**
   - 分析類型和時間戳
   - 整體評分和等級

2. **💰 估值分析**
   - 內在價值評估
   - 市場價格比較
   - 投資價值判斷

3. **🏥 健康報告**
   - 財務健康評分 (0-100分)
   - 營運效率評估
   - 風險指標分析
   - 產業對比分析

4. **🎯 投資建議**
   - 具體行動建議 (BUY/HOLD/SELL)
   - 信心度評分
   - 風險等級評估
   - 建議理由說明

5. **📈 進場價格**
   - 當前市場價格
   - 建議進場價格區間
   - 價格合理性分析

### 技術實現
- **LineBotController**: 智能指令識別和處理
- **ComprehensiveAnalysisEngine**: 綜合分析引擎
- **HealthReportGenerator**: 健康報告生成器
- **FlexMessageGenerator**: 美觀的LINE訊息

### 資料來源
- **股票資料**: StockDataAdapter
- **ETF資料**: ETFDataAdapter
- **分析引擎**: ComprehensiveAnalysisEngine
- **健康評分**: HealthScoreCalculator

## 🔧 技術架構

### 分層架構
```
┌─────────────────┐
│   LINE Bot      │ ← 用戶介面
├─────────────────┤
│  Controllers    │ ← 請求處理
├─────────────────┤
│    Services     │ ← 業務邏輯
├─────────────────┤
│   Adapters      │ ← 資料適配
├─────────────────┤
│ External APIs   │ ← 外部資料
└─────────────────┘
```

### 核心組件
- **LineBotController**: LINE訊息處理和路由
- **StockDataAdapter**: 股票資料獲取
- **ETFDataAdapter**: ETF資料獲取
- **ComprehensiveAnalysisEngine**: 綜合分析
- **HealthReportGenerator**: 健康報告
- **FlexMessageGenerator**: 訊息格式化

## 📈 使用流程

### 1. 用戶輸入
用戶在LINE中輸入體質分析指令，如 "2330 體質"

### 2. 指令識別
系統自動識別體質分析請求，提取股票/ETF代碼

### 3. 資料獲取
根據代碼類型，從相應的資料源獲取完整資料

### 4. 綜合分析
執行多維度的體質分析，包括：
- 財務健康評估
- 估值分析
- 風險評估
- 投資建議生成

### 5. 結果呈現
生成美觀的Flex Message，包含所有分析結果

## 🧪 測試覆蓋

### 測試範圍
- ✅ 體質分析請求識別 (6個測試案例)
- ✅ 體質分析處理流程 (5個測試案例)
- ✅ 幫助訊息更新 (1個測試案例)
- ✅ 文字訊息處理 (1個測試案例)

### 測試結果
```
Test Suites: 1 passed, 1 total
Tests:       13 passed, 13 total
Time:        10.292 s
```

## 🚀 部署狀態

### 編譯狀態
- ✅ TypeScript 編譯成功
- ✅ 所有依賴解析正常
- ✅ 測試套件執行通過
- ✅ 功能完整可用

### 環境要求
- Node.js 18+
- Firebase Functions
- LINE Bot API
- 外部股票資料API

## 🔮 未來規劃

### 短期目標
1. **批量分析**: 支援多股票同時體質分析
2. **歷史追蹤**: 體質變化趨勢分析
3. **個人化設定**: 用戶偏好和風險設定

### 中期目標
1. **產業對比**: 同業體質比較分析
2. **異常警報**: 體質惡化自動通知
3. **進階指標**: 更多財務健康指標

### 長期目標
1. **機器學習**: 智能體質預測
2. **投資組合**: 整體投資組合健康評估
3. **市場分析**: 宏觀經濟對體質的影響

## 📞 支援與回饋

如有問題或建議，請透過以下方式聯繫：
- GitHub Issues
- LINE Bot 直接回饋
- 開發團隊內部溝通

---

**最後更新**: 2024年12月
**版本**: 1.0.0
**狀態**: ✅ 生產就緒

